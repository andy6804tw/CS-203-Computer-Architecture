<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><title>Check Sum Encoder/Decoder</title>
  
   
  <script language="JavaScript">

function clear(form)
{
		form.tr_data1.value="";
		form.tr_data2.value="";
		form.tr_data3.value="";
		form.tr_data4.value="";
		form.tr_data5.value="";
		form.tr_data6.value="";
		form.tr_data7.value="";
		form.tr_data8.value="";
		form.tr_data9.value="";
		form.tr_data10.value="";

		form.checksum.value="";
		form.recd_data1.value="";
		form.recd_data2.value="";
		form.recd_data3.value="";
		form.recd_data4.value="";
		form.recd_data5.value="";
		form.recd_data6.value="";
		form.recd_data7.value="";
		form.recd_data8.value="";
		form.recd_data9.value="";
		form.recd_data10.value="";
		form.recd_checksum.value="";
		form.got_checksum.value="";
		form.calc_checksum.value="";
		form.fault.value="";
}

function clear_output(form)
{
	form.got_checksum.value="";
	form.calc_checksum.value="";
	form.fault.value="";
}


function single_precision(data_array_gzip, gzip_count) 
{
	var decimal_array = new Array(gzip_count);
	var modulo2powern=Math.pow(2,data_array_gzip[0].length);
	var decimal_checksum=0;

	for (i=0; i<gzip_count; i++)
	{
		decimal_array[i]=parseInt(data_array_gzip[i],2);
		decimal_checksum+=decimal_array[i];
	}
	
	decimal_checksum=decimal_checksum%modulo2powern;

	var checksum=decimal_checksum.toString(2);

	return checksum;

}

function double_precision(data_array_gzip, gzip_count) 
{
	var decimal_array = new Array(gzip_count);
	var modulo2powern=Math.pow(2,2*data_array_gzip[0].length);
	var decimal_checksum=0;

	for (i=0; i<gzip_count; i++)
	{
		decimal_array[i]=parseInt(data_array_gzip[i],2);
		decimal_checksum+=decimal_array[i];
	}

	decimal_checksum=decimal_checksum%modulo2powern;

	var checksum=decimal_checksum.toString(2);

	return checksum;

}

function residue(data_array_gzip, gzip_count) 
{
	var decimal_array = new Array(gzip_count);
	var modulo2powern=Math.pow(2,data_array_gzip[0].length);
	var decimal_checksum=0;

	for (i=0; i<gzip_count; i++)
	{
		decimal_array[i]=parseInt(data_array_gzip[i],2);
		decimal_checksum+=decimal_array[i];
	}

	if (decimal_checksum>=modulo2powern)
		decimal_checksum=(decimal_checksum+Math.floor(decimal_checksum/modulo2powern))%modulo2powern;

	var checksum=decimal_checksum.toString(2);

	return checksum;
}

function honeywell(data_array_gzip, gzip_count) 
{
	var data_block = new Array(gzip_count/2);

	for (i=0; i<gzip_count/2; i++)
		data_block[i]="0"+data_array_gzip[2*i]+data_array_gzip[2*i+1];

	var decimal_array = new Array(gzip_count);
	var modulo2powern=Math.pow(2,2*data_array_gzip[0].length);
	var decimal_checksum=0;

	for (i=0; i<gzip_count/2; i++)
	{
		decimal_array[i]=parseInt(data_block[i],2);
		decimal_checksum+=decimal_array[i];
	}
	decimal_checksum=decimal_checksum%modulo2powern;

	var checksum=decimal_checksum.toString(2);

	return checksum;
}

function single_radio_impl (form)
{
	var single_checked = form.single_radio.checked;
	
	if (single_checked == true) 
	{
		form.double_radio.checked = false;
		form.residue_radio.checked = false;
		form.honeywell_radio.checked = false;
	}
}

function double_radio_impl (form)
{
	var double_checked = form.double_radio.checked;
	
	if (double_checked == true) 
	{
		form.single_radio.checked = false;
		form.residue_radio.checked = false;
		form.honeywell_radio.checked = false;
	}
}

function residue_radio_impl (form)
{
	var residue_checked = form.residue_radio.checked;

	if (residue_checked == true) 
	{
		form.double_radio.checked = false;
		form.single_radio.checked = false;
		form.honeywell_radio.checked = false;
	}
}

function honeywell_radio_impl (form)
{
	
	var honeywell_checked = form.honeywell_radio.checked;
	
	if (honeywell_checked == true) 
	{
		form.double_radio.checked = false;
		form.residue_radio.checked = false;
		form.single_radio.checked = false;
	}
}


function encode(form, data_array_gzip, gzip_count)
{
	var single_checked = form.single_radio.checked;
	var double_checked = form.double_radio.checked;
	var residue_checked = form.residue_radio.checked;
	var honeywell_checked = form.honeywell_radio.checked;

	var checksum;
	var data_length=data_array_gzip[0].length;
	if (form.base[1].checked)
	{
		if (data_length > 8)
		{
			alert ("Please do not exceed 8 hex digits");
			clear(form);
			return;	
		}
		for (i=0; i<gzip_count; i++)
		{
			data_array_gzip[i] = hex_to_binary(data_array_gzip[i]);
			for (j=data_array_gzip[i].length; j<4*data_length; j++)
				data_array_gzip[i]="0"+data_array_gzip[i];
		}
	}
	else
	{
		if (data_length > 32)
		{
			alert ("Please do not exceed 32 binary digits");
			clear(form);
			return;	
		}
	}

	if (single_checked==true)
	{ 
		checksum = single_precision(data_array_gzip, gzip_count);
		if (form.base[1].checked)
			checksum = binary_to_hex(checksum);
		for (j=checksum.length; j<data_length; j++)
			checksum ="0"+checksum;
	}

	if (double_checked==true)
	{
		checksum = double_precision(data_array_gzip, gzip_count);
		if (form.base[1].checked)
			checksum = binary_to_hex(checksum);
		for (j=checksum.length; j<2*data_length; j++)
			checksum ="0"+checksum;
	}

	if (residue_checked==true)
	{
		checksum = residue(data_array_gzip, gzip_count);
		if (form.base[1].checked)
			checksum = binary_to_hex(checksum);
		for (j=checksum.length; j<data_length; j++)
			checksum ="0"+checksum;
	}

	if (honeywell_checked==true)
	{
		if (gzip_count%2)
		{
			alert ("Please Type Even Number of Data Words to Compute Honeywell Checksum");
			clear(form);
			return;
		}
		checksum = honeywell(data_array_gzip, gzip_count);
		if (form.base[1].checked)
			checksum = binary_to_hex(checksum);
		for (j=checksum.length; j<2*data_length; j++)
			checksum ="0"+checksum;
	}

form.checksum.value=checksum;
form.recd_checksum.value=checksum;

}

function encode_check_input (form)
{
	clear_output(form);

	if (form.base[0].checked && ((!is_binary(form.data1.value)) || (!is_binary(form.data2.value)) || (!is_binary(form.data3.value)) || (!is_binary(form.data4.value)) || (!is_binary(form.data5.value)) || (!is_binary(form.data6.value)) || (!is_binary(form.data7.value)) || (!is_binary(form.data8.value)) || (!is_binary(form.data9.value)) || (!is_binary(form.data10.value))))
	{

		alert("Data Word must be in binary form");
		clear(form);
		return ;
	}

if (form.base[1].checked && ((!is_hex(form.data1.value)) || (!is_hex(form.data2.value)) || (!is_hex(form.data3.value)) || (!is_hex(form.data4.value)) || (!is_hex(form.data5.value)) || (!is_hex(form.data6.value)) || (!is_hex(form.data7.value)) || (!is_hex(form.data8.value)) || (!is_hex(form.data9.value)) || (!is_hex(form.data10.value))))
	{

		alert("Data Word must be in hex form");
		clear(form);
		return ;
	}

var data_array = new Array(form.data1.value, form.data2.value, form.data3.value, form.data4.value, form.data5.value, form.data6.value, form.data7.value, form.data8.value, form.data9.value, form.data10.value);

var data_array_gzip = new Array(10);
var gzip_index=0;

for (i=0; i<10; i++)
{
if (data_array[i].length != 0)
{
data_array_gzip[gzip_index] = data_array[i];
gzip_index++;
}
}
var gzip_count = gzip_index;

for (i=gzip_count; i<10; i++)
data_array_gzip[i]="";

for (i=0; i<gzip_count; i++)
for (j=i; j<gzip_count; j++)
if (data_array_gzip[i].length != data_array_gzip[j].length)
{
		alert("Data Widths not equal");
                clear(form);
		return;
}

	
	form.tr_data1.value=data_array_gzip[0];
	form.tr_data2.value=data_array_gzip[1];
	form.tr_data3.value=data_array_gzip[2];
	form.tr_data4.value=data_array_gzip[3];
	form.tr_data5.value=data_array_gzip[4];
	form.tr_data6.value=data_array_gzip[5];
	form.tr_data7.value=data_array_gzip[6];
	form.tr_data8.value=data_array_gzip[7];
	form.tr_data9.value=data_array_gzip[8];
	form.tr_data10.value=data_array_gzip[9];

	form.recd_data1.value=data_array_gzip[0];
	form.recd_data2.value=data_array_gzip[1];
	form.recd_data3.value=data_array_gzip[2];
	form.recd_data4.value=form.tr_data4.value;
	form.recd_data5.value=data_array_gzip[4];
	form.recd_data6.value=data_array_gzip[5];
	form.recd_data7.value=data_array_gzip[6];
	form.recd_data8.value=data_array_gzip[7];
	form.recd_data9.value=data_array_gzip[8];
	form.recd_data10.value=data_array_gzip[9];

	encode(form, data_array_gzip, gzip_count);
}

function decode_check_input (form)
{
clear_output(form);
	if (form.base[0].checked && ((!is_binary(form.recd_data1.value)) || (!is_binary(form.recd_data2.value)) || (!is_binary(form.recd_data3.value)) || (!is_binary(form.recd_data4.value)) || (!is_binary(form.recd_data5.value)) || (!is_binary(form.recd_data6.value)) || (!is_binary(form.recd_data7.value)) || (!is_binary(form.recd_data8.value)) || (!is_binary(form.recd_data9.value)) || (!is_binary(form.recd_data10.value)) || (!is_binary(form.recd_checksum.value))))
	{

		alert("Data Word & Checksum must be in binary form");
		clear_output(form);
		return ;
	}

	if (form.base[1].checked && ((!is_hex(form.recd_data1.value)) || (!is_hex(form.recd_data2.value)) || (!is_hex(form.recd_data3.value)) || (!is_hex(form.recd_data4.value)) || (!is_hex(form.recd_data5.value)) || (!is_hex(form.recd_data6.value)) || (!is_hex(form.recd_data7.value)) || (!is_hex(form.recd_data8.value)) || (!is_hex(form.recd_data9.value)) || (!is_hex(form.recd_data10.value)) || (!is_hex(form.recd_checksum.value))))
	{

		alert("Data Word & Checksum must be in hex form");
		clear_output(form);
		return ;
	}

	var recd_array = new Array(form.recd_data1.value, form.recd_data2.value, form.recd_data3.value, form.recd_data4.value, form.recd_data5.value, form.recd_data6.value, form.recd_data7.value, form.recd_data8.value, form.recd_data9.value, form.recd_data10.value, form.recd_checksum.value);

	var recd_array_gzip = new Array(11);
	var recd_gzip_index=0;

	for (i=0; i<10; i++)
		if (recd_array[i].length != 0)
		{
			recd_array_gzip[recd_gzip_index] = recd_array[i];
			recd_gzip_index++;
		}

	var recd_gzip_count = recd_gzip_index;

	for (i=recd_gzip_count; i<10; i++)
		recd_array_gzip[i]="";
	recd_array_gzip[10] = recd_array[10];

	for (i=0; i<recd_gzip_count; i++)
		for (j=i; j<recd_gzip_count; j++)
			if (recd_array_gzip[i].length != recd_array_gzip[j].length)
			{
				alert("Data Widths not equal");
         	    		clear_output(form);
				return;
			}




	decode(form, recd_array_gzip, recd_gzip_count);
}

function decode (form, recd_array_gzip, recd_gzip_count)
{	
	var single_checked = form.single_radio.checked;
	var double_checked = form.double_radio.checked;
	var residue_checked = form.residue_radio.checked;
	var honeywell_checked = form.honeywell_radio.checked;
	var data_length = recd_array_gzip[0].length;

	var checksum_length = recd_array_gzip[10].length;

	if (form.base[1].checked)
	{
		if (data_length > 8)
		{
			alert ("Please do not exceed 8 hex digits");
			clear_output(form);
			return;	
		}

		for (i=0; i<recd_gzip_count; i++)
		{
			recd_array_gzip[i] = hex_to_binary(recd_array_gzip[i]);
			for (j=recd_array_gzip[i].length; j<4*data_length; j++)
				recd_array_gzip[i]="0"+recd_array_gzip[i];
		}
	recd_array_gzip[10] = hex_to_binary(recd_array_gzip[10]);
	for (j=recd_array_gzip[10].length; j<4*checksum_length; j++)
		recd_array_gzip[10]="0"+recd_array_gzip[10];
	}
	else
	{
		if (data_length > 32)
		{
			alert ("Please do not exceed 32 binary digits");
			clear_output(form);
			return;	
		}
	}
	if (single_checked==true)
	{
		if (recd_array_gzip[10].length != recd_array_gzip[0].length)
		{
			alert("Data/Checksum Widths do not match for Single Precision");
			clear_output(form);
			return;
		}

		checksum = single_precision(recd_array_gzip, recd_gzip_count);
		if (form.base[1].checked)
			checksum = binary_to_hex(checksum);
		for (j=checksum.length; j<data_length; j++)
			checksum ="0"+checksum;
	}

	if (double_checked==true)
	{
		if (recd_array_gzip[10].length != 2*recd_array_gzip[0].length)
		{
			alert("Data/Checksum Widths do not match for Double Precision");
			clear_output(form);
			return;
		}

		checksum = double_precision(recd_array_gzip, recd_gzip_count);
		if (form.base[1].checked)
			checksum = binary_to_hex(checksum);
		for (j=checksum.length; j<2*data_length; j++)
			checksum ="0"+checksum;
	}
	
	if (residue_checked==true)
	{
		if (recd_array_gzip[10].length != recd_array_gzip[0].length)
		{
			alert("Data/Checksum Widths do not match for Residue Checksum Method");
			clear_output(form);
			return;
		}

		checksum = residue(recd_array_gzip, recd_gzip_count);
		if (form.base[1].checked)
			checksum = binary_to_hex(checksum);
		for (j=checksum.length; j<data_length; j++)
			checksum ="0"+checksum;
	}

	if (honeywell_checked==true)
	{
		if (recd_array_gzip[10].length != 2*recd_array_gzip[0].length)
		{
			alert("Data/Checksum Widths do not match for Honeywell Checksum Method");
			clear_output(form);
			return;
		}
		if (recd_gzip_count%2)
		{
			alert ("Please Type Even Number of Data Words to Compute Honeywell Checksum");
			clear_output(form);
			return;
		}
		checksum = honeywell(recd_array_gzip, recd_gzip_count);
		if (form.base[1].checked)
			checksum = binary_to_hex(checksum);
		for (j=checksum.length; j<2*data_length; j++)
			checksum ="0"+checksum;
	}

	form.calc_checksum.value = checksum;
	form.got_checksum.value=form.recd_checksum.value;
	
	if (form.recd_checksum.value != form.calc_checksum.value)
	{
		form.fault.value="yes";
	}
	else
	{
		form.fault.value="no";
	}

}

function is_binary(data)
{
	for (i=0;i<data.length;i++)
	{

var digit=parseInt(data.substring(i,i+1));
		if ((digit != 0) && (digit != 1))
		{

			return false;
		}

	}

	return true;

}

function is_hex(data)
{
	for (i=0;i<data.length;i++)
	{

		var digit=parseInt(data.substring(i,i+1),16);
		if (!((digit >= 0) && (digit <= 15)))
			return false;
	}
return true;
}


function hex_to_binary(data)
{
	var decimal = parseInt(data, 16);
	var binary = decimal.toString(2);
	return binary;
}

function binary_to_hex(data)
{
	var decimal = parseInt(data, 2);
	var hex = decimal.toString(16);
	return hex;
}

  </script></head>

<body bgcolor="wheat">
 
<h1 align="center">Checksum Encoder/Decoder</h1>
  
<hr>  
<form> 
  <h3><a href="../../../../../../www-unix.ecs.umass.edu/~srsriniv/courses/fault/Checksum_Encoder_Decoder_-_Instructions.html">Instructions
&amp; Information</a><br>
  </h3>
  <h3>Checksum Encoder</h3>
 
  <table border="1" width="100%" cellpadding="10">
 <tbody>
      <tr>

  <td width="30%">
Binary<input type="radio" name="base" value="Binary" checked="checked">
Hex<input type="radio" name="base" value="Hex"><br><br>
<center>

<b>Data Word1: </b> 		<input type="text" name="data1">  <br>
 	<b>Data Word2: </b><br>
 		<input type="text" name="data2">  <br>
 	<b>Data Word3: </b><br>
 		<input type="text" name="data3">   <br>
 	<b>Data Word4: </b><br>
 		<input type="text" name="data4">   <br>
 	<b>Data Word5: </b><br>
 		<input type="text" name="data5">   <br>
 	<b>Data Word6: </b><br>
 		<input type="text" name="data6">   <br>
 	<b>Data Word7: </b><br>
 		<input type="text" name="data7">   <br>
 	<b>Data Word8: </b><br>
 		<input type="text" name="data8">   <br>
 	<b>Data Word9: </b><br>
 		<input type="text" name="data9">   <br>
 	<b>Data Word10: </b><br>
 		<input type="text" name="data10">   <br>
</center>
 <br>
 	<input type="radio" name="single_radio" onclick="single_radio_impl(this.form);" checked="checked">Single Precision
Checksum<br>
 	<input type="radio" name="double_radio" onclick="double_radio_impl(this.form);">Double Precision Checksum<br>
 	<input type="radio" name="residue_radio" onclick="residue_radio_impl(this.form);"> Residue Checksum<br>
 	<input type="radio" name="honeywell_radio" onclick="honeywell_radio_impl(this.form);"> Honeywell Checksum<br>

<br><i>Type in as many datawords (upto 10) as you want.</i>
  </td>
  <td align="center">  <input type="button" name="checksum_encode" value="Encode --&gt;" onclick="encode_check_input(this.form)">  </td>
  <td>  <center>

 	<b>Transmitted Data Word1: </b><br>
 		<input type="text" name="tr_data1">  <br>
 	<b>Transmitted Data Word2: </b><br>
 		<input type="text" name="tr_data2">  <br>
 	<b>Transmitted Data Word3: </b><br>
 		<input type="text" name="tr_data3">   <br>
 	<b>Transmitted Data Word4: </b><br>
 		<input type="text" name="tr_data4">   <br>
 	<b>Transmitted Data Word5: </b><br>
 		<input type="text" name="tr_data5">   <br>
 	<b>Transmitted Data Word6: </b><br>
 		<input type="text" name="tr_data6">   <br>
 	<b>Transmitted Data Word7: </b><br>
 		<input type="text" name="tr_data7">   <br>
 	<b>Transmitted Data Word8: </b><br>
 		<input type="text" name="tr_data8">   <br>
 	<b>Transmitted Data Word9: </b><br>
 		<input type="text" name="tr_data9">   <br>
 	<b>Transmitted Data Word10: </b><br>
 		<input type="text" name="tr_data10">   <br>
 	<b>Transmitted Checksum:</b><br>
 		<input type="text" name="checksum">  </center></td>

  </tr>
  
    </tbody>
  </table>
 <br>
 
  <hr>  
  <h3>Checksum Decoder</h3>
  
  <table border="1" width="100%" cellpadding="10">
  <tbody>
      <tr>
        <td width="30%"><center>
 	<b>Received Data Word1: </b><br>
 		<input type="text" name="recd_data1">  <br>
 	<b>Received Data Word2: </b><br>
 		<input type="text" name="recd_data2">  <br>
 	<b>Received Data Word3: </b><br>
 		<input type="text" name="recd_data3">   <br>
 	<b>Received Data Word4: </b><br>
 		<input type="text" name="recd_data4">   <br>
 	<b>Received Data Word5: </b><br>
 		<input type="text" name="recd_data5">   <br>
 	<b>Received Data Word6: </b><br>
 		<input type="text" name="recd_data6">   <br>
 	<b>Received Data Word7: </b><br>
 		<input type="text" name="recd_data7">   <br>
 	<b>Received Data Word8: </b><br>
 		<input type="text" name="recd_data8">   <br>
 	<b>Received Data Word9: </b><br>
 		<input type="text" name="recd_data9">   <br>
 	<b>Received Data Word10: </b><br>
 		<input type="text" name="recd_data10">   <br>

  	<b>Received Checksum: </b><br>
 		<input type="text" name="recd_checksum"> <br>
  <br></center>
        <i>Change these to simulate error during data transmission</i>  </td>
  <td align="center">  <input type="button" name="checksum_decode" value="Decode --&gt;" onclick="decode_check_input(this.form)">  </td>
  <td><center>
 	<b>Calculated Checksum: </b><br>
 		<input type="text" name="calc_checksum">  <br>
 	<b>Received Checksum: </b><br>
 		<input type="text" name="got_checksum">  <br>
 	<b>Fault Detected: </b><br>
 		<input type="text" name="fault">  <br>
  </center></td>
  </tr>
    </tbody>
  </table>
  
  <hr> 
  </form>
</body></html>