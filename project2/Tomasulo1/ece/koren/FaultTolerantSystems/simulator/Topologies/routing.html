<script language="javascript">
function check_req_fields()
{
 if(isNaN(document.forms[0].nodes.value))
	{
		alert(" Please enter Valid Number of nodes");
	return false;
	}
if(isNaN(document.forms[0].pl.value) || document.forms[0].pl.value>1 )
	{
		alert(" Please enter valid value for probability of link failure");
		return false;
	}
if (document.forms[0].nodes.value.length == 0)
{
	alert(" Enter number of nodes");
	return false;
}
if(document.forms[0].pl.value.length == 0)
{
	alert(" Enter Link failure probability");
	return false;
}
if(document.forms[0].sn.value.length != 4)
{
	alert(" Enter source in 4 bit binary");
	return false;
}
if(document.forms[0].dn.value.length != 4)
{
	alert(" Enter destination in 4 bit binary");
	return false;
}
if(document.forms[0].skip.value.length == 0)
{
	alert(" Please enter skip diatance");
	return false;
}
	

//extracting source and destination
	var source1 = new Array();
	var ineq_pos = new Array();
	var source,N;
	source = document.forms[0].sn.value;
	source1 = source.split("");
	N = document.forms[0].nodes.value;
	
	var dest1 = new Array();
	var dest,p,i,dist = 0;
	dest = document.forms[0].dn.value;
	dest1 = dest.split("");
	var s = 0, d = 0;
	n = Math.log(N)/Math.log(2);
	for(i=0;i<=document.forms[0].sn.value.length-1; i++)
{
	s = s+ source1[i] * Math.pow(2,document.forms[0].sn.value.length-1-i);
	
	d = d + dest1[i] * Math.pow(2,document.forms[0].dn.value.length-1-i);
	
	
	
}
//alert(" value of source " +s);
//alert(" value of dest" +d);
if(s==d)
{
  document.forms[0].hcop.value = 0;
  document.forms[0].chop.value = 0;
  document.forms[0].torusop.value = 0;
  //not working
  document.forms[0].analysis.value = "Source and destination are the same node";
  
 }
 else
 {
//hypercube routing
function IsInteger(x)
{
	var temp = parseInt(x);
	if (temp == x) 
	{
	 return true;
	} 
     return false;
 }
if(IsInteger(n))
{
	var route_cube = new Array();
	for( i =0;i<=document.forms[0].sn.value.length-1;i++)
	{

		if(source1[i]!=dest1[i])
		{
			
			dist = dist+1;
			
		}
	}
	
	
	document.forms[0].hcop.value = dist;
}
else
{
	
	document.forms[0].hcop.value = "NA";
}

// chordal network routing
var skip;
skip = document.forms[0].skip.value;
var dia;
//alert(" skip is" +skip);
//alert(" n is " +N);
skip1 = parseInt(skip);
skip2 = skip1 + 1;
//alert(" skip1 is " +skip2);
dia1 = N/skip2;
//alert(" dia1 is " +dia1);
dia2 = dia1 + skip1 - 1;
dia = Math.round(dia2);
//alert( " dia is " +dia);
var r = d-s;
//alert(" difference is" +r); 
var len = 0;

 if( s<d)
 {
	if((d-s) ==1 || (d-s) == N - skip)
	{
		len = 1;
	//alert(" 1st condition");
	}
	
	else if( (d-s)%skip > 1 && (d-s)%skip <= dia)
	{
		for(i=2;i<=dia;i++)
		{
			if((d-s)%dia == i)
			{
				len = i;
				//alert(" 2st condition");
				
			}
		}
	}
	else if((d-s)%skip == 1)
	{
		//alert("inside here");
		len = dia-1;
	}
	else 
	{
		if((d-s)%skip == 0)
		{
		 len = 2;
		// alert(" 3st condition");
		 }
		 else if((d-s)%dia == 4)
		 {
			len = 2;
		}
			
	}
	//alert(" its here");
}
else
{
	//alert(" its in the else");
	if((s-d)%skip == 1)
	{
		len = 3;
	}
	else if( (s-d)%skip > 1 && (s-d)%skip <= dia)
	{
		for(i=2;i<=dia;i++)
		{
			if((s-d)%skip == i)
			{
				len = i;
				
			}
		}
	}
	else 
	{
		if((s-d)%skip == 0)
		{
		 len = 1;
		 //alert(" 3st condition");
		 }
	}

}
document.forms[0].chop.value = len;
// torus routing

var route = 0,ps = 0,pd = 0;
 for( i =0;i<=document.forms[0].sn.value.length-1;i++)
 {
	ps = ps^ source[i];
	pd = pd ^ dest[i];
}
 if(dist ==1)
 {
	route=1;
	if( source[n-1]==1 || dest[n-1]==1)
	{
		route = 2;
	}
 }
 else if(dist==2)
 {
	if(ineq_pos[n-1]==1 && ineq_pos[n-2]==1 || ineq_pos[0]==1 && ineq_pos[1]==1)
	{
		route=1;
	}
	else
	{
		route = 3;
	}
}
else if(dist == 3)
{
	route = 4;
}
else
{
	if((ps==1||pd==1)&& (source[n-1]==1 || dest[n-1]==1))
	{
		route = 2;
	}
	else if(ps==0||pd==0)
	{
		route = 4;
	}
	else
	{
		route = 2;
	}
}

document.forms[0].torusop.value = route;
}
	if(document.forms[0].hcop.value != "NA")
	{
		if(len<dist && len<route)
		{
			document.forms[0].analysis.value = " The chordal network generates the shortest path for the given source and destination pair. In chordal networks the links provide forward communication and the chords provide backward communication. Due to the presence of both these types of links the maximum number of links that need to be traversed is small. But this is true only for small networks. As the number of nodes increase so does the diameter of the network thus increasing the shortest distance.";
		}
 	
		else if(dist<len && dist<route)
		{
			document.forms[0].analysis.value = "The hypercube provides the shortest path between a source and destination pair. The hypercube traversal is based on the hamming distance and traverses though links of different dimensions to move from source to destination. As the dimensions are different routing is simple in this case and paths are short.";
		}
	
	
		else if(route<len && route<dist)
		{
			document.forms[0].analysis.value = "The torus network provides the shortest path for the given source destination pair. The drawback in a torus network is that due to unidirectional links, sometimes neighbouring nodes need to take wrap around links to move from source to destination. Torus routing in more complicated compared to the other 2 but provides multiple path options.";
		}
		else if( route == len && route < dist)
		{
			document.forms[0].analysis.value = " Either a torus or a chordal network would be a option but in this case reliability calculation also need to be considered to choose the right network for implementation";
		}
		else if( dist == len && len<route)
		{
			document.forms[0].analysis.value = "  Either a chordal or a hypercube network would be a option but in this case reliability calculation also need to be considered to choose the right network for implementation";
		}
		else if( route == dist && route<len)
		{
			document.forms[0].analysis.value = " Either a torus or a hypercube network would be a option but in this case reliability calculation also need to be considered to choose the right network for implementation";
		}
		else if( route == len == dist)
		{
			document.forms[0].analysis.value = " All 3 networks provide the same shortest path and reliability needs to be considered to decide to the most suitable implementation";
		}
		}
	else
	{
		if(len<route)
		{
			document.forms[0].analysis.value = " The chordal network generates the shortest path for the given source and destination pair. In chordal networks the links provide forward communication and the chords provide backward communication. Due to the presence of both these types of links the maximum number of links that need to be traversed is small. But this is true only for small networks. As the number of nodes increase so does the diameter of the network thus increasing the shortest distance.";
		}
		else if( len == route)
		{
			document.forms[0].analysis.value = " All 3 networks provide the same shortest path and reliability needs to be considered to decide to the most suitable implementation";
		}
		else	
		{
			document.forms[0].analysis.value = "The torus network provides the shortest path for the given source destination pair. The drawback in a torus network is that due to unidirectional links, sometimes neighbouring nodes need to take wrap around links to move from source to destination. Torus routing in more complicated compared to the other 2 due but provides multiple path options.";
		}
	}
		
}
</script>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
 <HEAD>
  <TITLE> Routing Algorithm </TITLE>
  <body>
  <form action="routing.html">
  <h1 align = 'center'> Routing Algorithm</h1>
  <br>
  <br>
   <table width=100% border=1 cellpadding=3 cellspacing=1 bgcolor="#DFDEDF" >
<tr>
<td align="center" colspan=6 bgcolor="#00DDFF"><font size="3" face="arial"><b>INPUTS</b></td>
</tr>
<tr bgcolor="#FFFFFF"  >
<td><font size="3" face="arial"><b>Number of Nodes</b></font></td>
<td><input type="text" name="nodes" id="nodes" value=""></td>
<td><font size="3" face="arial"><b>Link Failure Probability (pl)</b></font></td>
<td><input type="text" name="pl" id="pl" value=""></td>
</tr>
<tr bgcolor="#FFFFFF">
<td><font size="3" face="arial"><b>Source Node(in 4 bit binary format)</b></font></td>
<td><input type="text" name="sn" id="sn" value=""></td>
<td><font size="3" face="arial"><b>Destination Node(in 4 bit binary format)</b></font></td>
<td><input type="text" name="dn" id="dn" value=""></td>
</tr>
<tr bgcolor="#FFFFFF">
<td><font size="3" face="arial"><b>Skip Distance for Chordal Network</b></font></td>
<td colspan=3><input type="text" name="skip" id="skip" value=""></td>
</tr>
<tr>
<td colspan=4 align="center">
   <input type="button" style="height: 36px; width: 100px "    
            value="Process" 	onclick="javascript:check_req_fields()">
</td>
</tr>
</table>
<br>
<br>
 <table width=100% border=1 cellpadding=3 cellspacing=1 bgcolor="#DFDEDF" >
<tr>
<td colspan= 3 align="center" bgcolor="#00DDFF"><font size="3" face="arial"><b>OUTPUTS</b></td>
</tr>
<tr bgcolor="#FFFFFF"  >
<td><font size="3" face="arial" color="blue"><b>Torus Network</b></font></td>
<td><font size="3" face="arial" color="blue"><b>Hyper-Cube Network</b></font></td>
<td><font size="3" face="arial" color="blue"><b>Chordal Network</b></font></td>
</tr>
<tr>
</tr>
<tr>
<td><input type="text" name="torusop" style="background-color:#EEEEEE;"
                    readonly="readonly" value=""></td>
<td><input type="text" name="hcop"  style="background-color:#EEEEEE;"
                    readonly="readonly" value=""></td>
<td><input type="text" name="chop"  style="background-color:#EEEEEE;"
                    readonly="readonly" value=""></td>
</tr>
<tr>
<td bgcolor="#00DDFF" colspan=3 align="center"><font size="3" face="arial"><b>Analysis</b></font></td>
</tr>
<tr>
<td colspan=3 align="center"><textarea name="analysis" rows="3" cols="80" 
                       readonly="readonly" value=""></textarea></td>
</tr>

</table>
<a href = "homepage.html" align = 'right'><h3> BACK</h3></a>
<a href = "reliability.html" align = 'right'><h3>Reliability Calculation</h3></a>
 </HEAD>

</form>
  
 </BODY>
</HTML>
