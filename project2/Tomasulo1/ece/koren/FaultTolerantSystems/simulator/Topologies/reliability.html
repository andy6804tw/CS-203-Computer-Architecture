<script language=javascript>
function fact(num)
{
	var rval=1;
    for (var i = 2; i <= num; i++)
        rval = rval * i;
    return rval;
}

function ProcessNode(id){
if(isNaN(document.forms[0].node.value))
	{
		alert(" Please enter Valid Number of nodes");
	return false;
	}
if(isNaN(document.forms[0].pl.value) || document.forms[0].pl.value>1 )
	{
		alert(" Please enter valid value for probability");
		return false;
	}
	
if(isNaN(document.forms[0].pn.value) || document.forms[0].pn.value>1)
	{
		alert(" Please enter valid value for node probability");
		return false;
	}
    var firstvalue = '';
   var secondvalue = '';
   if (document.forms[0].node.value.length == 0)
   {
		alert("Please enter Number of nodes");
		return false;
   }
   if (document.forms[0].pl.value.length == 0)
   {
		alert("Please enter probability of link failure");
		return false;
   }
   if (document.forms[0].pn.value.length == 0)
   {
		alert("Please enter probability of node failure");
		return false;
   }
   
  if(document.forms[0].pl.value == 1 && document.forms[0].pn.value == 1)
  {
	document.forms[0].out1.value = R = 0;
	document.forms[0].out2.value = NRH = 0;
	document.forms[0].out5.value = NRC = 0;
	document.forms[0].analysis.value = " Failure rates of links and nodes are 1";
	return false;
}
else if(document.forms[0].node.value==1)
{
	document.forms[0].out1.value = R = 1- document.forms[0].pn.value;
	document.forms[0].out2.value = NRH = 1- document.forms[0].pn.value;
	document.forms[0].out5.value = NRC = 1- document.forms[0].pn.value;
	document.forms[0].analysis.value = " For a single node the reliability only depends of node failure rate";
	return false;
}
	
else
{
	//Torus odd reliability calculation
	N = document.forms[0].node.value;
	fl = parseFloat(document.forms[0].pl.value);
	fn = parseFloat(document.forms[0].pn.value);
	var R,fl,fn,f,rn,rn1,rn2,i,v,v1,v2,d,d1,d2,n,N;

    f = fl +fn*(1-fl);
//	alert(" f is " +f);
	var res,res1,res2,res3,res4;
	var value,value1,value2,value3,value4,value5,value6;
	var out,out1,out2,out3,net;
	net = 0;
	net = N%2;

if(net==1)
{
	n = (N-1)/2;

	if(n == 2)
	{
		d1 = 1;
	}
	else
	{
		d1 = 0;
	}
	if(n==1)
	{
		d = 1;
	}
	else
	{
		d = 0;
    }
	if(n==3)
	{
		d2 = 1;
	}
	else
	{
		d2 = 0;
	}
	
   	if( n >= 4)
	{ 
		v2 = 1;
		v1 = 1;
		v = 1;
	}
	else if (n>=3)
	{
		v1 = 1;
		v =1 ;
		v2 = 0;
	}
	else if (n>=2)
	{
		v2 = 0;
		v1 = 0;
		v = 1;
	}
	else 
	{
		v = v1=v2 = 0;
		
	}
	rn2 = 0;
	rn1 = 0;
	
	for(i = 1; i <= n-3; i++)
	{   res = Math.pow(((1-f*f)/2),i);
	    res1  = Math.pow(1-f,n-i-1) * v2 ;
		res2 = [(1-f*f) *d1 ];
		res3 = Math.pow(((1-f*f)/2),n-2);
		res4 = (2-f -f*f*f) * v;
		rn2 = (res *res1) + res2 + (res3*res4);
	
	}
	
	value5 = 0;
	for( i = 0; i <= n-2;i++)
	{
	   value=Math.pow((1-f*f),n-1);
	   value1=Math.pow(1+f*f-f*f*f,i+1) *rn2 * v1;
	   value2=(value * value1)/Math.pow(2,(i+1));
	   value3=Math.pow((((1-f*f)*(1-f)*(1+f*f-f*f*f))/2),n-1) ;
	   value4 = f*f;
	  
	   var a = f;

	   value5 = 1.00+ a;
	   value6 = value5 - value4;
	   rn1 = value2 + (value3 * value5) + rn1;
 
	}

	rn = rn1 * v + (1-fl-f*fl)*d;

	R = (1-f*f) *rn * (1+ f*f - f*f*f*f*f - f*f*f*f*f*f + f*f*f*f*f*f*f)*(1-fl);
	var R1 = R.toFixed(6)
	 document.forms[0].out1.value = R1;
	
	//end of torus odd
}
//even torus calculation
else
{
	n = N/2;
	
	if(n == 2)
	{
		d1 = 1;
	}
	else
	{
		d1 = 0;
	}
	if(n==1)
	{
		d = 1;
	}
	else
	{
		d = 0;
    }
	if(n==3)
	{
		d2 = 1;
	}
	else
	{
		d2 = 0;
	}
	
   	if( n >= 4)
	{ 
		v2 = 1;
		v1 = 1;
		v = 1;
	}
	else if (n>=3)
	{
		v1 = 1;
		v =1 ;
		v2 = 0;
	}
	else if (n>=2)
	{
		v2 = 0;
		v1 = 0;
		v = 1;
	}
	else 
	{
		v = v1=v2 = 0;
		
	}
	res = (1-f*f*f)/3 
	res1 = Math.pow(2,n-3) * Math.pow((1-f*f),n-1);
	res2 = 0;
	for(i=0;i<=n-3;i++)
	{
		res2 = res2 + ([Math.pow((1-f*f),i+1) * Math.pow((1-f),(n-2-i))]/Math.pow(2,i));
	}
	res3 = [Math.pow(1-f,n-2) * (1-f*f)*(1-f*f*f)]/3
	rn2 = res * [res1 + res2] + res3;

	out2 = 0;
	out1 = [d2/2 +(3*v2)/Math.pow(2,n-1)] * Math.pow(1-f*f,n);
	out3 = (v2/4 +d2/2) * (1-f*f) * (1-f*f) * Math.pow(1-f,n-2);
	for(i=0; i<=n-4;i++)
	{
		out2 = out2 + ([Math.pow(1-f*f,3+i) * Math.pow(1-f,n-3-i)]/Math.pow(2,3+i));
	}
	rn3 = parseFloat(out1 + 3 * out2 + out3);
	value = [2*Math.pow(1-f*f*f,n-2)]/Math.pow(3,n-2);
	value2 = Math.pow((1-f*f*f)/3 , n-2) * rn2;
	value1 = 0;
	for(i=0;i<=n-4;i++)
	{
		value1 = value1 + [Math.pow((1-f*f*f),n-3-i)/ Math.pow(3,(n-3-i))];
	}
	value3 = parseFloat(value + value1);
	value4 = value3 * rn3;
	rn1 = value4 + value2;
	rn =(rn1* v )+ ((1-fl) * d) ;
	  
	R = (1-f*f*f*f) * rn * (1-fl);
	var R1 = R.toFixed(6)
	 document.forms[0].out1.value = R1;
	
}
//end of torus reliability calculation

//Hypercube reliability
function IsInteger(x)
{
	var temp = parseInt(x);
	if (temp == x) 
	{
	 return true;
	} 
     return false;
 }
 n = Math.log(N)/Math.log(2);
	
if(IsInteger(n))
{
	var y,result,result1,result2;
	var NR = new Array();
	NR[2] = Math.pow(1-fl,4) + 4*fl*Math.pow(1-fl,3);
	
	//n = Math.log(N)/Math.log(2);
	
	for(i = 2;i<=n-1;i++)
	{
		y = Math.pow(2,i-1);
		result = NR[i]* NR[i] * (1 - Math.pow(fl ,y));
		result1 = 2 * NR[i] * (1-NR[i]) * Math.pow((1-fl) ,y);
		result2 =  2 * NR[i] * (1-NR[i]) * Math.pow(2,i-1) * fl * Math.pow((1-fl) ,(y-1)) * (1 - Math.pow(fl,i-1));
		NR[i+1] = result + result1+ result2;
	
	}
	y = Math.pow(2,n);
	NRH = Math.pow((1-fn), y) * NR[n];
	if( N == 2)
	{
	document.forms[0].out2.value = (1-fl);
	NRH = 1-fl;
	}
	else
	{
	var NR1 = NRH.toFixed(6)
	 document.forms[0].out2.value = NR1;
	
	}
}
else
{
	
	document.forms[0].out2.value = "NA";
	NRH = "NA";
}
	
//end of hypercube

// Chordal network reliability
  var val, val1 = 0;
  var p = 1-fl;
  var pn = 1-fn;
  var h = 3;
	val = Math.pow(pn,N/2) *[Math.pow(p,N/2) + Math.pow(p,N/2) - Math.pow(p*p,N/2) + (N/2 * fl*fl*Math.pow( (p*p),( N/2) -1))];
	for( i = 0;i<(h-1)/2 ; i++)
	{
		val1 = val1 + Math.pow(fn,N/2) * Math.pow(pn , N/2 - i) * Math.pow( p*p , (N-i-2)/2);
	}
	NRC = N/2 * val1 + val;
	var NRC1 = NRC.toFixed(6)
	 document.forms[0].out5.value = NRC1;
	
}
	if(NRH!="NA")
	{
		if(R>NRC && R>NRH)
		{
			document.forms[0].analysis.value = "For the given number of nodes and link reliability a Torus network would provide a the most reliable network. The is because the number of nodes provided is large and only a torus would provide good end to end connectivity with such large number of nodes. But the drawback of a torus network is its lack of fault tolerance. When the nodes are few then small fault could disconnect the network";
		}
 		else if(NRC>R && NRC > NRH)
		{
			document.forms[0].analysis.value = "For the given set of nodes and link reliability a Chordal network would be most reliable. This is because for the chordal network for the given set of link reliability and nodes can tolerant more failures compared to the other 2 networks. The advantage of the chordal network is the availability of multiple paths between souce and destination of the same length. But as we increase the number of nodes the reliability drops and providing fault tolerance becomes a difficult task";
		}
	
		else 
		{
			document.forms[0].analysis.value = "For the given set of nodes and link reliability the hypercube provides the most reliable network. This network provides good reliability for a small number of nodes and cause be easily augmented with fault recovery capabilities. But as the nodes increase so do the number of links thus increasing the chance of failure. But this network proves to be the most efficient among the three";
		}
		}
   
   else
   {
		if(R>NRC)
		{
			document.forms[0].analysis.value = "For the given number of nodes and link reliability a Torus network would provide a the most reliable network. The is because the number of nodes provided is large and only a torus would provide good end to end connectivity with such large number of nodes. But the drawback of a torus network is its lack of fault tolerance. When the nodes are few then small fault could disconnect the network";
		}
		else
		{
			document.forms[0].analysis.value = "For the given set of nodes and link reliability a Chordal network would be most reliable. This is because for the chordal network for the given set of link reliability and nodes can tolerant more failures compared to the other 2 networks. The advantage of the chordal network is the availability of multiple paths between souce and destination of the same length. But as we increase the number of nodes the reliability drops and providing fault tolerance becomes a difficult task";
		}
	}
 }
</script>
<head>
 <TITLE> Reliability calculator </TITLE>
</head>
<body>
<form action="reliab.html">
<h1 align = 'center'> Reliabillity Calculator </h1>
<br>
<br>
<br>
<table width=100% border=1 cellpadding=3 cellspacing=1 bgcolor="#DFDEDF" >
<tr>
<td align="center" colspan=6 bgcolor="#00DDFF"><font size="3" face="arial"><b>INPUTS</b></td>
</tr>
<tr>
<font size="2" face="arial">* For Hypercube the number of nodes has to be a power of 2</font>
</tr>
<tr bgcolor="#FFFFFF" >
<td><font size="3" face="arial"><b>Number of Nodes</b></font></td>
<td><input type="text" name="node" id="node" value=""></td>
<td><font size="3" face="arial"><b>Link Failure Probability (pl)</b></font></td>
<td><input type="text" name="pl" id="pl" value=""></td>
<td><font size="3" face="arial"><b>Node Failure Probability (pn)</b></font></td>
<td><input type="text" name="pn" id="pn" value=""></td>
</tr>
<tr></tr>
<tr bgcolor="#FFFFFF" >
<td colspan=6 align="center">
   <input type="button" style="height: 36px; width: 100px "    
            value="Process" 	onclick="javascript:ProcessNode('tableproc1')">
               
</td>
</tr>
</table>
<br>
<br>
<table width=100% border=1 cellpadding=3 cellspacing=1 bgcolor="#DFDEDF" id="tableproc1">
<tr>
<td colspan= 6 align="center" bgcolor="#00DDFF"><font size="3" face="arial"><b>OUTPUTS</b></td>
</tr>
<tr bgcolor="#FFFFFF"  >
<td><font size="3" face="arial" color="blue"><b>Torus Network</b></font></td>
<td><font size="3" face="arial" color="blue"><b>Hyper-Cube Network</b></font></td>
<td><font size="3" face="arial" color="blue"><b>Chordal Network</b></font></td>
</tr>
<tr bgcolor="#FFFFFF" >
<td><input type="text" name="out1" id="out1" 
                    style="background-color:#EEEEEE;"
                    readonly="readonly" size=12 value=""></td>
<td><input type="text" name="out2" id="out2" 
                   style="background-color:#EEEEEE;"
                    readonly="readonly" size=12 value=""></td>
<td><input type="text" name="out5" id="out5" 
                   style="background-color:#EEEEEE;"
                    readonly="readonly" size=12   
			        value=""></td>
</tr>
<tr>
<td bgcolor="#00DDFF" colspan=3 align="center"><font size="3" face="arial"><b>Analysis</b></font></td>
</tr>

             <td colspan=3 bgcolor="#FFFFFF" align="center"><textarea name="analysis" rows="3" cols="80" 
                       style="background-color:#DDDDDD;" readonly="readonly" value=""></textarea>
               </td>
</tr>
</table>
<a href = "homepage.html" alin = 'right'><h3> BACK</h3></a>
<a href = "routing.html" align = 'right'><h3>Routing</h3></a>
 </HEAD>
</form>
</body>
</html>
